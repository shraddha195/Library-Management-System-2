package lbproj;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.ArrayList;
import java.util.Collection;
import java.util.List;

import javax.xml.crypto.Data;

public class lbconnections {

	public static void createTbl(String sql) {
		 try(Connection con=DBConnection.getConnection()){
			 Statement stmt=con.createStatement();
			 stmt.executeUpdate(sql);
			 System.out.println("Book created sucessfully");
		 }
		 catch(SQLException e) {e.printStackTrace();}
	}//createTbl
	public static void insertData(int id,String bname,String author) {
		 String query="INSERT INTO Book(id,bname,author) VALUES(?,?,?)";
		 try(Connection con=DBConnection.getConnection();
			 PreparedStatement pstm=con.prepareStatement(query);){
				pstm.setInt(1,id);
				pstm.setString(2,bname);
				pstm.setString(3, author);
				pstm.executeUpdate();
		 }catch(SQLException e) {e.printStackTrace();}
	 }//insertData
	public static void deletbook() {
		
	}//deletbook end
	
	public static void updateData(int id,String bname,String author) {
		 String query="UPDATE Book SET bname=?,author=? WHERE id=?";
		 try(Connection con=DBConnection.getConnection();
			 PreparedStatement pstm=con.prepareStatement(query);){
			 pstm.setInt(1,id);
			 pstm.setString(2,bname);
			 pstm.setString(3, author);
			 int rowAffected=pstm.executeUpdate();
		 }catch(SQLException e) {e.printStackTrace();}
	 }
	public static void showTable() {
		 String sql="select * from Book";
		 try(Connection con=DBConnection.getConnection();
			 Statement stmt=con.createStatement();
			 ResultSet rs=stmt.executeQuery(sql);){
			 System.out.println("Data from Book");
			 while(rs.next()) {
				 System.out.println(rs.getInt("id")+" | "+rs.getString("name")+" | "+rs.getString("author"));
			 }
		 }catch(SQLException e) {e.printStackTrace();}
	 }
	
	
	public static void creatememberTbl(String sql1) {
		 try(Connection con=DBConnection.getConnection()){
			 Statement stmt=con.createStatement();
			 stmt.executeUpdate(sql1);
			 System.out.println("Member created sucessfully");
		 }
		 catch(SQLException e) {e.printStackTrace();}
	}//createTbl
	public static void insertDatamembers(int id,String name) {
		 String query="INSERT INTO Members (id,name) VALUES(?,?)";
		 try(Connection con=DBConnection.getConnection();
			 PreparedStatement pstm=con.prepareStatement(query);){
				pstm.setInt(1,id);
				pstm.setString(2,name);
				pstm.executeUpdate();
		 }catch(SQLException e) {e.printStackTrace();}
	 }//insertDatamembers end
	public static void showmemberTable() {
		 String sql="select * from Member";
		 try(Connection con=DBConnection.getConnection();
			 Statement stmt=con.createStatement();
			 ResultSet rs=stmt.executeQuery(sql);){
			 System.out.println("Data from Member");
			 while(rs.next()) {
				 System.out.println(rs.getInt("id")+" | "+rs.getString("name"));
			 }
		 }catch(SQLException e) {e.printStackTrace();}
	 }
}
